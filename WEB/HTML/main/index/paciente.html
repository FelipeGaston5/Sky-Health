<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Área do Paciente - Sky Health</title>
    <link rel="stylesheet" href="../../../CSS/style.css" />
    <link rel="stylesheet" href="../../../CSS/main/index/style.css" />
    <link rel="stylesheet" href="../../../CSS/main/index/paciente-theme.css" />
    <link rel="stylesheet" href="../../../CSS/main/index/paciente-theme-dark.css" />
</head>

<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <div class="logo-brand" role="img" aria-label="Sky Health"></div>
                <h1>Área do Paciente</h1>
            </div>
            <nav>
                <!-- Navegação futura -->
            </nav>
        </div>
    </header>

    <main>
        <div class="dashboard-card">
            <div class="dashboard-layout">
                <aside class="sidebar card">
                    <div class="card-header">
                        <h3>Menu</h3>
                    </div>
                    <nav class="side-nav tabs">
                        <button data-tab="prescricoes" class="active">Minhas Prescrições</button>
                        <button data-tab="agendamentos">Meus Agendamentos</button>
                        <button data-tab="notificacoes">Notificações</button>
                        <button data-tab="exames">Resultados de Exames</button>
                        <button data-tab="historico">Histórico Médico</button>
                    </nav>
                </aside>
                <section class="content card">
                    <div class="card-header">
                        <div>
                            <h2>Painel do Paciente</h2>
                            <small id="paciente-info" class="muted">—</small>
                        </div>
                        <div class="inline">
                            <a class="btn btn-secondary" href="../../users/paciente.html">Meu Perfil</a>
                            <button id="btn-refresh" class="btn btn-secondary" type="button">Atualizar</button>
                        </div>
                    </div>
                    <div class="page-title">
                        <h2 id="page-section-title">Minhas Prescrições</h2>
                        <p class="muted">Acompanhe suas prescrições, agendamentos e notificações.</p>
                    </div>
                    <div class="patient-form">
                        <section id="tab-prescricoes" class="tab-panel active">
                            <h4 class="section-title">Prescrições emitidas</h4>
                            <div class="panel-header">
                                <h3>Lista de Prescrições</h3>
                                <div class="controls">
                                    <div class="form-group">
                                        <label for="pres-search">Buscar</label>
                                        <input id="pres-search" type="search" placeholder="Tipo, CRM, descrição..." />
                                    </div>
                                </div>
                            </div>
                            <table class="list">
                                <thead>
                                    <tr>
                                        <th>Tipo</th>
                                        <th>Médico (CRM)</th>
                                        <th>Validade</th>
                                        <th>Descrição</th>
                                    </tr>
                                </thead>
                                <tbody id="pres-list">
                                    <tr class="empty-state">
                                        <td colspan="4">Carregando…</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div id="pres-msg" class="alert success" style="display:none;"></div>
                        </section>

                        <section id="tab-agendamentos" class="tab-panel">
                            <h4 class="section-title">Próximos atendimentos</h4>
                            <div class="panel-header">
                                <h3>Meus Agendamentos</h3>
                                <div class="controls">
                                    <div class="form-group">
                                        <label for="ag-filter-status">Filtrar por status</label>
                                        <select id="ag-filter-status">
                                            <option value="">Todos</option>
                                            <option value="Agendado">Agendado</option>
                                            <option value="Realizado">Realizado</option>
                                            <option value="Cancelado">Cancelado</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="ag-search">Buscar</label>
                                        <input id="ag-search" type="search" placeholder="Médico, tipo, data..." />
                                    </div>
                                </div>
                            </div>
                            <table class="list">
                                <thead>
                                    <tr>
                                        <th>Médico</th>
                                        <th>Tipo</th>
                                        <th>Data</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="ag-list">
                                    <tr class="empty-state">
                                        <td colspan="4">Carregando…</td>
                                    </tr>
                                </tbody>
                            </table>
                        </section>

                        <section id="tab-notificacoes" class="tab-panel">
                            <h4 class="section-title">Central de notificações</h4>
                            <div class="panel-header">
                                <h3>Notificações</h3>
                            </div>
                            <div class="empty-state-card">
                                <p>Nenhuma notificação no momento.</p>
                                <small class="muted">Eventos importantes serão exibidos aqui.</small>
                            </div>
                        </section>

                        <!-- Resultados de Exames -->
                        <section id="tab-exames" class="tab-panel">
                            <h4 class="section-title">Resultados / Laudos de Exames</h4>
                            <div class="panel-header">
                                <h3>Meus Exames</h3>
                                <div class="controls">
                                    <div class="form-group">
                                        <label for="ex-search">Buscar</label>
                                        <input id="ex-search" type="search" placeholder="Tipo, nome, médico..." />
                                    </div>
                                </div>
                            </div>
                            <!-- Exportações removidas aqui: agora disponíveis individualmente dentro do modal -->
                            <table class="list">
                                <thead>
                                    <tr>
                                        <th>Tipo</th>
                                        <th>Nome</th>
                                        <th>Status</th>
                                        <th>Data Resultado</th>
                                        <th>Médico</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="ex-list">
                                    <tr class="empty-state">
                                        <td colspan="6">Carregando…</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div id="ex-msg" class="alert success" style="display:none;"></div>
                        </section>

                        <!-- Histórico Médico Consolidado -->
                        <section id="tab-historico" class="tab-panel">
                            <h4 class="section-title">Histórico Médico Consolidado</h4>
                            <p class="muted">Gere e exporte um dossiê completo com seus dados e registros.</p>
                            <div class="form-actions" style="gap:.5rem;display:flex;flex-wrap:wrap;">
                                <button id="hist-refresh" type="button" class="btn btn-secondary">Atualizar
                                    Histórico</button>
                                <button id="hist-export-txt" type="button" class="btn btn-secondary">Exportar
                                    TXT</button>
                                <button id="hist-export-xml" type="button" class="btn btn-secondary">Exportar
                                    XML</button>
                                <button id="hist-export-json" type="button" class="btn btn-secondary">Exportar
                                    JSON</button>
                                <button id="hist-export-pdf" type="button" class="btn btn-primary">Exportar / Imprimir
                                    (PDF)</button>
                            </div>
                            <div id="hist-status" class="alert success" style="display:none;margin-top:1rem;"></div>
                            <div id="hist-conteudo" class="card"
                                style="margin-top:1rem; max-height:400px; overflow:auto; padding:1rem; font-size:.9rem; line-height:1.35; white-space:pre-wrap; font-family:'Courier New',monospace; word-break:break-word;">
                            </div>
                            <div class="form-actions" style="margin-top:1rem;">
                                <button id="hist-import" type="button" class="btn btn-outline">Importar HMC</button>
                                <input id="hist-import-input" type="file" accept=".json,.xml,.txt"
                                    style="display:none" />
                            </div>
                        </section>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <footer class="footer-fixed">
        <div class="footer-content">
            <p>Área do Paciente</p>
        </div>
    </footer>

    <script src="../../../JS/script.js"></script>
    <script src="../../../JS/link/paciente.js"></script>
    <script src="../../../JS/link/medico.js"></script>
    <script src="../../../JS/main/paciente-dashboard.js"></script>
    <!-- Script de tema local removido para evitar conflito: uso central deve aplicar body[data-theme="dark"] ou body.dark-mode -->

    <!-- Modal Visualização de Exame -->
    <div id="modal-exame" class="modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
        <div class="modal-box">
            <div class="modal-header">
                <h3 id="mx-titulo">Exame</h3>
                <button type="button" class="modal-close" id="mx-close" aria-label="Fechar">×</button>
            </div>
            <div class="modal-body">
                <div class="inline" style="flex-wrap:wrap;gap:.4rem;margin-bottom:.75rem" id="mx-actions">
                    <button type="button" class="btn btn-secondary btn-sm" id="mx-copy">Copiar</button>
                    <button type="button" class="btn btn-secondary btn-sm" id="mx-exp-txt">TXT</button>
                    <button type="button" class="btn btn-secondary btn-sm" id="mx-exp-json">JSON</button>
                    <button type="button" class="btn btn-secondary btn-sm" id="mx-exp-xml">XML</button>
                    <button type="button" class="btn btn-primary btn-sm" id="mx-exp-pdf">Imprimir / PDF</button>
                </div>
                <div class="chips" id="mx-chips"></div>
                <div class="grid-2">
                    <div class="field-block">
                        <h4>Tipo</h4>
                        <div class="value" id="mx-tipo">—</div>
                    </div>
                    <div class="field-block">
                        <h4>Nome Exame</h4>
                        <div class="value" id="mx-nome">—</div>
                    </div>
                    <div class="field-block">
                        <h4>Médico Solicitante</h4>
                        <div class="value" id="mx-medico">—</div>
                    </div>
                    <div class="field-block">
                        <h4>CRM</h4>
                        <div class="value" id="mx-crm">—</div>
                    </div>
                    <div class="field-block">
                        <h4>Data Coleta</h4>
                        <div class="value" id="mx-coleta">—</div>
                    </div>
                    <div class="field-block">
                        <h4>Data Resultado</h4>
                        <div class="value" id="mx-resultado">—</div>
                    </div>
                </div>
                <div class="field-block">
                    <h4>Valores de Referência</h4>
                    <pre id="mx-ref">—</pre>
                </div>
                <div class="field-block">
                    <h4>Justificativa</h4>
                    <pre id="mx-justificativa">—</pre>
                </div>
                <div class="field-block">
                    <h4>Descrição Detalhada</h4>
                    <pre id="mx-descricao">—</pre>
                </div>
                <div class="field-block">
                    <h4>Discussão</h4>
                    <pre id="mx-discussao">—</pre>
                </div>
                <div class="field-block">
                    <h4>Conclusão</h4>
                    <pre id="mx-conclusao">—</pre>
                </div>
                <div class="field-block">
                    <h4>Laudo (Texto Livre)</h4>
                    <pre id="mx-laudo">—</pre>
                </div>
                <div class="grid-2">
                    <div class="field-block">
                        <h4>Analista Responsável</h4>
                        <div class="value" id="mx-analista">—</div>
                    </div>
                    <div class="field-block">
                        <h4>Diretor Técnico</h4>
                        <div class="value" id="mx-diretor">—</div>
                    </div>
                    <div class="field-block">
                        <h4>Local</h4>
                        <div class="value" id="mx-local-nome">—</div>
                    </div>
                    <div class="field-block">
                        <h4>Endereço Local</h4>
                        <div class="value" id="mx-local-endereco">—</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Preview Importação HMC -->
    <div id="modal-hmc" class="modal-overlay" role="dialog" aria-modal="true" aria-hidden="true" style="display:none;">
        <div class="modal-box" style="max-width:900px;">
            <div class="modal-header">
                <h3 id="mhmc-titulo">Pré-visualização de Importação</h3>
                <button type="button" class="modal-close" id="mhmc-close" aria-label="Fechar">×</button>
            </div>
            <div class="modal-body" style="display:flex;flex-direction:column;gap:1rem;">
                <div id="mhmc-meta" class="muted"
                    style="font-size:.75rem;letter-spacing:.5px;text-transform:uppercase;"></div>
                <div class="modal-actions" style="display:flex;gap:.5rem;flex-wrap:wrap;">
                    <button type="button" class="btn btn-secondary btn-sm" id="mhmc-toggle">Mostrar completo</button>
                    <button type="button" class="btn btn-primary btn-sm" id="mhmc-confirm">Confirmar Importação</button>
                    <button type="button" class="btn btn-outline btn-sm" id="mhmc-cancel">Cancelar</button>
                </div>
                <pre id="mhmc-preview" style="max-height:55vh;"></pre>
            </div>
        </div>
    </div>
</body>

</html>